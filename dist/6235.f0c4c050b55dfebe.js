(self.webpackChunkmemCourrier=self.webpackChunkmemCourrier||[]).push([[6235],{26235:(ne,w,s)=>{s.r(w),s.d(w,{InstallerModule:()=>te});var W=s(13859),B=s(74809),H=s(52971),A=s(47544),j=s(10467),y=s(13025),h=s(7673),m=s(88141),f=s(99437),t=s(60687),d=s(68018),S=s(70587);let I=(()=>{class n{constructor(){this.steps=[]}setStep(e){this.steps.push(e)}isStepAlreadyLaunched(e){return this.steps.filter(r=>e===r.idStep).length>0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac})}}return n})();var C=s(29397),k=s(72560),b=s(55609),M=s(77085),O=s(551),v=s(64977);function Q(n,l){1&n&&t.\u0275\u0275text(0," ... ")}function K(n,l){1&n&&t.\u0275\u0275element(0,"i",11)}function J(n,l){1&n&&t.\u0275\u0275element(0,"i",12)}function Z(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"div",13),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",e.msgErr," ")}}function Y(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item")(1,"div",9)(2,"span",10),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,Q,1,0)(5,K,1,0,"i",11)(6,J,1,0,"i",12)(7,Z,2,1,"div",13),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275classProp("endStep","OK"===e.state||"KO"===e.state)("currentStep","inProgress"===e.state),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.label),t.\u0275\u0275advance(),t.\u0275\u0275conditional("inProgress"===e.state?4:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional("OK"===e.state?5:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional("KO"===e.state?6:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional(""!==e.msgErr?7:-1)}}function X(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",18),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.goToInstance())}),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()}2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"lang.goToNewInstance")))}function tt(n,l){1&n&&(t.\u0275\u0275elementStart(0,"button",17),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,"lang.cancel")))}function et(n,l){if(1&n&&(t.\u0275\u0275element(0,"span",14),t.\u0275\u0275elementStart(1,"div",15),t.\u0275\u0275template(2,X,3,3,"button",16)(3,tt,3,3,"button",17),t.\u0275\u0275elementEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275conditional(!e.isInstallError()&&e.isInstallComplete()?2:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional(e.isInstallError()||!e.isInstallBegin()?3:-1)}}let nt=(()=>{class n{constructor(e,r,a,i,p,c,g){this.translate=e,this.data=r,this.dialogRef=a,this.http=i,this.installerService=p,this.notify=c,this.authService=g,this.steps=[],this.customId="",this.disableAnimation=!0}ngOnInit(){var e=this;return(0,j.A)(function*(){e.initSteps()})()}ngAfterViewInit(){setTimeout(()=>this.disableAnimation=!1)}launchInstall(){var e=this;return(0,j.A)(function*(){let r;for(let a=0;a<e.data.length&&(e.steps[a].state="inProgress",r=yield e.doStep(a),r);a++);})()}initSteps(){this.data.forEach((e,r)=>{0===r?this.customId=e.body.customId:e.body.customId=this.customId,this.steps.push({idStep:e.idStep,label:e.description,state:"",msgErr:""})})}doStep(e){return new Promise(r=>{this.installerService.isStepAlreadyLaunched(this.data[e].idStep)?(this.steps[e].state="OK",r(!0)):this.http[this.data[e].route.method.toLowerCase()](this.data[e].route.url,this.data[e].body).pipe((0,m.M)(()=>{this.steps[e].state="OK",this.installerService.setStep(this.steps[e]),r(!0)}),(0,f.W)(a=>(this.steps[e].state="KO",this.steps[e].msgErr=void 0!==a.error.lang?this.translate.instant("lang."+a.error.lang):a.error.errors,r(!1),(0,h.of)(!1)))).subscribe()})}isInstallBegin(){return this.steps.filter(e=>""===e.state).length!==this.steps.length}isInstallComplete(){return 0===this.steps.filter(e=>""===e.state).length}isInstallError(){return this.steps.filter(e=>"KO"===e.state).length>0}goToInstance(){this.http.request("DELETE","../rest/installer/lock",{body:{customId:this.customId}}).pipe((0,m.M)(e=>{this.authService.noInstall=!1,window.location.href=e.url,this.dialogRef.close("ok")}),(0,f.W)(e=>(this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(y.MAT_DIALOG_DATA),t.\u0275\u0275directiveInject(y.MatDialogRef),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(I),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(k.u))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-install-action"]],standalone:!1,decls:17,vars:9,consts:[["installStepAction",""],[1,"mat-dialog-content-container"],["mat-dialog-content",""],["hideToggle","","expanded",""],[1,"launch-action"],[1,"text-center","primary"],["mat-raised-button","","type","button",1,"primary",2,"font-size","25px","padding","20px",3,"click"],[1,"far","fa-hdd"],[3,"expanded"],["mat-line","",1,"step"],[1,"stepLabel"],[1,"fa","fa-check",2,"color","green"],[1,"fa","fa-times",2,"color","red"],["role","alert",1,"alert-message","alert-message-danger",2,"margin-top","30px","min-width","100%"],[1,"divider-modal"],["mat-dialog-actions","",1,"actions"],["mat-raised-button","","mat-button","",1,"primary"],["mat-raised-button","","mat-button","",3,"mat-dialog-close"],["mat-raised-button","","mat-button","",1,"primary",3,"click"]],template:function(r,a){if(1&r){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",1)(1,"div",2)(2,"mat-accordion")(3,"mat-expansion-panel",3)(4,"div",4)(5,"h2",5),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"button",6),t.\u0275\u0275listener("click",function(){return t.\u0275\u0275restoreView(i),t.\u0275\u0275reference(13).open(),t.\u0275\u0275resetView(a.launchInstall())}),t.\u0275\u0275element(9,"i",7),t.\u0275\u0275text(10),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(12,"mat-expansion-panel",8,0),t.\u0275\u0275repeaterCreate(14,Y,8,9,"mat-list-item",null,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275template(16,et,4,2),t.\u0275\u0275elementEnd()}2&r&&(t.\u0275\u0275advance(),t.\u0275\u0275property("@.disabled",a.disableAnimation),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(7,5,"lang.almostThere")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(11,7,"lang.launchInstall")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("expanded",!1),t.\u0275\u0275advance(2),t.\u0275\u0275repeater(a.steps),t.\u0275\u0275advance(2),t.\u0275\u0275conditional(a.isInstallComplete()||a.isInstallError()||!a.isInstallBegin()?16:-1))},dependencies:[b.MatLegacyButton,M.MatLine,O.MatAccordion,O.MatExpansionPanel,y.MatDialogClose,y.MatDialogContent,y.MatDialogActions,v.MatLegacyListItem,d.D9],styles:[".step[_ngcontent-%COMP%]{opacity:.5;transition:all .2s}.step[_ngcontent-%COMP%]   .stepLabel[_ngcontent-%COMP%]{transition:all .2s}.currentStep[_ngcontent-%COMP%]{opacity:1;transition:all .2s}.currentStep[_ngcontent-%COMP%]   .stepLabel[_ngcontent-%COMP%]{font-size:150%;transition:all .2s}.endStep[_ngcontent-%COMP%]{opacity:1}.mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:none}.launch-action[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}}return n})();var T=s(5964),at=s(49563),rt=s(95410),E=s(94751),ot=s(78910),N=s(46753),F=s(31425),_=s(87863),o=s(76971),P=s(15103),u=s(39495),D=s(63609),z=s(60055),it=s(84855);const st=n=>({value1:n});function lt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-option",7),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n){const e=l.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,2,"lang."+e+"Full")," ")}}function pt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item"),t.\u0275\u0275element(1,"mat-icon",11),t.\u0275\u0275elementStart(2,"div",12),t.\u0275\u0275text(3),t.\u0275\u0275elementStart(4,"small",13),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd()()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",e.label," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(e.id)}}function ct(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list")(1,"div",8),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275repeaterCreate(4,pt,6,2,"mat-list-item",null,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(6,"mat-divider")),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(3,1,"lang.instancesList")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275repeater(e.customs)}}function mt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list-item"),t.\u0275\u0275element(1,"mat-icon",14),t.\u0275\u0275elementStart(2,"div",12),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275classMap(e.icon),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(4,3,e.desc))}}let dt=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this.http=r,this.notify=a,this._formBuilder=i,this.authService=p,this.langs=[],this.appVersion=P.c.BASE_VERSION,this.steps=[{icon:"fas fa-check-square",desc:"lang.prerequisiteCheck"},{icon:"fa fa-database",desc:"lang.databaseCreation"},{icon:"fa fa-database",desc:"lang.dataSampleCreation"},{icon:"fa fa-hdd",desc:"lang.docserverCreation"},{icon:"fas fa-tools",desc:"lang.stepCustomizationActionDesc"},{icon:"fa fa-user",desc:"lang.adminUserCreation"}],this.customs=[]}ngOnInit(){this.stepFormGroup=this._formBuilder.group({lang:["fr",o.Validators.required]}),this.getLang(),this.authService.noInstall||this.getCustoms()}getLang(){this.http.get("../rest/languages").pipe((0,m.M)(e=>{this.langs=Object.keys(e.langs).filter(r=>"nl"!==r)}),(0,f.W)(e=>(this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}changeLang(e){this.translate.use(e)}getCustoms(){this.http.get("../rest/installer/customs").pipe((0,m.M)(e=>{this.customs=e.customs}),(0,f.W)(e=>(this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}initStep(){return!1}getInfoToInstall(){return[]}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(k.u))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-welcome"]],standalone:!1,decls:30,vars:20,consts:[[1,"stepContent"],[1,"stepContentTitle"],[2,"text-align","center"],["svgIcon","memLogoFull",1,"memLogoFull"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline","floatLabel","never"],["formControlName","lang","required","",3,"selectionChange"],[3,"value"],["mat-subheader",""],["mat-raised-button","","href","https://edissyum.com/","target","_blank",1,"primary"],[2,"font-style","italic","padding-top","30px","text-align","right",3,"innerHTML"],["mat-list-icon","",1,"fas","fa-box-open",2,"color","#3A7C00"],["mat-line",""],[2,"color","#666"],["mat-list-icon","",1,"primary"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",2),t.\u0275\u0275element(5,"mat-icon",3),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"form",4)(7,"mat-form-field",5)(8,"mat-label"),t.\u0275\u0275text(9),t.\u0275\u0275pipe(10,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(11,"mat-select",6),t.\u0275\u0275listener("selectionChange",function(p){return a.changeLang(p.value)}),t.\u0275\u0275repeaterCreate(12,lt,3,4,"mat-option",7,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275element(14,"mat-divider"),t.\u0275\u0275template(15,ct,7,3),t.\u0275\u0275elementStart(16,"mat-list")(17,"div",8),t.\u0275\u0275text(18),t.\u0275\u0275pipe(19,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275repeaterCreate(20,mt,5,5,"mat-list-item",null,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(22,"mat-divider"),t.\u0275\u0275elementStart(23,"p"),t.\u0275\u0275text(24),t.\u0275\u0275pipe(25,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(26,"a",9),t.\u0275\u0275text(27," edissyum.com "),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"p",10),t.\u0275\u0275pipe(29,"translate"),t.\u0275\u0275elementEnd()),2&r&&(t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind2(3,7,"lang.welcomeApp",t.\u0275\u0275pureFunction1(18,st,a.appVersion))," !"),t.\u0275\u0275advance(4),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(10,10,"lang.chooseAppLanguage")," : "),t.\u0275\u0275advance(3),t.\u0275\u0275repeater(a.langs),t.\u0275\u0275advance(3),t.\u0275\u0275conditional(a.customs.length>0?15:-1),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(19,12,"lang.installDescription")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275repeater(a.steps),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(25,14,"lang.externalInfoSite")," : "),t.\u0275\u0275advance(4),t.\u0275\u0275property("innerHTML",t.\u0275\u0275pipeBind1(29,16,"lang.maarchLicenceInstall"),t.\u0275\u0275sanitizeHtml))},dependencies:[o.\u0275NgNoValidate,o.NgControlStatus,o.NgControlStatusGroup,o.RequiredValidator,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,D.MatLegacySelect,z.MatLegacyOption,b.MatLegacyAnchor,M.MatLine,F.MatIcon,v.MatLegacyList,v.MatLegacyListItem,v.MatLegacyListIconCssMatStyler,v.MatLegacyListSubheaderCssMatStyler,it.MatDivider,d.D9],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.stepContent[_ngcontent-%COMP%]   .memLogoFull[_ngcontent-%COMP%]{width:300px;height:100px}.stepContent[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}.link[_ngcontent-%COMP%]{text-decoration:underline;color:var(--maarch-color-primary)!important}"]})}}return n})();var ut=s(3053),U=s(71731),gt=s(3383),ht=s(58493);const ft=["packageItem"];function vt(n,l){1&n&&(t.\u0275\u0275element(0,"app-maarch-message",6),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275property("mode","warning")("content",t.\u0275\u0275pipeBind1(1,2,"lang.isWarningPackage"))}function Ct(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-grid-tile")(1,"mat-list-item"),t.\u0275\u0275element(2,"mat-icon",12),t.\u0275\u0275elementStart(3,"div",13),t.\u0275\u0275text(4),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275element(6,"i",14,0),t.\u0275\u0275pipe(8,"translate"),t.\u0275\u0275elementEnd()()()),2&n){const e=l.$implicit;t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa iconCheckPackage icon_",e.state,""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(5,7,"lang.install_"+e.label)," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("id",e.label)("matTooltip",t.\u0275\u0275pipeBind1(8,9,"lang.install_"+e.label+"_desc"))("matTooltipClass","ok"!==e.state?"tooltip-"+e.state:"")}}function bt(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-list",7)(1,"div",10),t.\u0275\u0275text(2),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"mat-grid-list",11),t.\u0275\u0275repeaterCreate(5,Ct,9,11,"mat-grid-tile",null,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd()()),2&n){const e=l.$implicit,r=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(3,1,"lang."+e.key)),t.\u0275\u0275advance(3),t.\u0275\u0275repeater(r.packagesList[e.key])}}let yt=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this.http=r,this.notify=a,this._formBuilder=i,this.functionsService=p,this.prerequisites={},this.packagesList={general:[{label:"phpVersionValid",required:!0},{label:"writable",required:!0}],tools:[{label:"unoconv",required:!0},{label:"netcatOrNmap",required:!0},{label:"pgsql",required:!0},{label:"curl",required:!0},{label:"zip",required:!0},{label:"wkhtmlToPdf",required:!0},{label:"imagick",required:!0}],phpExtensions:[{label:"fileinfo",required:!0},{label:"pdoPgsql",required:!0},{label:"gd",required:!0},{label:"mbstring",required:!0},{label:"json",required:!0},{label:"gettext",required:!0},{label:"xml",required:!0}],phpConfiguration:[{label:"errorReporting",required:!0},{label:"displayErrors",required:!0}]},this.docMaarchUrl=this.functionsService.getDocBaseUrl()+"/guat/guat_prerequisites/home.html"}ngOnInit(){this.stepFormGroup=this._formBuilder.group({firstCtrl:["",o.Validators.required]}),this.getStepData()}getStepData(){this.http.get("../rest/installer/prerequisites").pipe((0,m.M)(e=>{this.prerequisites=e.prerequisites,Object.keys(this.packagesList).forEach(r=>{this.packagesList[r].forEach((a,i)=>{this.packagesList[r][i].state="displayErrors"===this.packagesList[r][i].label?this.prerequisites[this.packagesList[r][i].label]?"ok":"warning":this.prerequisites[this.packagesList[r][i].label]?"ok":"ko","phpVersionValid"===this.packagesList[r][i].label&&this.translate.setTranslation(this.translate.getDefaultLang(),{lang:{install_phpVersionValid_desc:this.translate.instant("lang.currentVersion")+" : "+this.prerequisites.phpVersion}},!0)})}),this.stepFormGroup.controls.firstCtrl.setValue(this.checkStep()),this.stepFormGroup.controls.firstCtrl.markAsUntouched()}),(0,f.W)(e=>(this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}initStep(){Object.keys(this.packagesList).forEach(e=>{this.packagesList[e].forEach((r,a)=>{"ko"===this.packagesList[e][a].state&&this.packageItem.toArray().filter(i=>i._elementRef.nativeElement.id===this.packagesList[e][a].label)[0].toggle()})})}checkStep(){let e="success";return Object.keys(this.packagesList).forEach(r=>{this.packagesList[r].forEach(a=>{"ko"===a.state&&(e="")})}),e}isValidStep(){return void 0!==this.stepFormGroup&&"success"===this.stepFormGroup.controls.firstCtrl.value}getFormGroup(){return this.stepFormGroup}getInfoToInstall(){return[]}isWarningPackage(){return"warning"===this.packagesList.phpConfiguration.find(r=>"displayErrors"===r.label).state}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(E.b))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-prerequisite"]],viewQuery:function(r,a){if(1&r&&t.\u0275\u0275viewQuery(ft,5),2&r){let i;t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.packageItem=i)}},standalone:!1,decls:18,vars:14,consts:[["packageItem","matTooltip"],[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-check-square"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],["target","_blank",1,"link",3,"href"],[3,"mode","content"],[2,"background","white"],[2,"text-align","center"],["mat-raised-button","","type","button",1,"primary",3,"click"],["mat-subheader",""],["cols","3","rowHeight","50px"],["mat-list-icon",""],["mat-line","",1,"packageName"],["matTooltipPosition","right",1,"fa","fa-info-circle",3,"id","matTooltip","matTooltipClass"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",1)(1,"h2",2),t.\u0275\u0275element(2,"i",3),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",4),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementStart(8,"a",5),t.\u0275\u0275text(9),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(10,vt,2,4,"app-maarch-message",6),t.\u0275\u0275repeaterCreate(11,bt,7,3,"mat-list",7,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275pipe(13,"keyvalue"),t.\u0275\u0275elementStart(14,"div",8)(15,"button",9),t.\u0275\u0275listener("click",function(){return a.getStepData()}),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,6,"lang.prerequisite"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,8,"lang.stepPrerequisite_desc")," : "),t.\u0275\u0275advance(2),t.\u0275\u0275propertyInterpolate("href",a.docMaarchUrl,t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(a.docMaarchUrl),t.\u0275\u0275advance(),t.\u0275\u0275conditional(a.isWarningPackage()?10:-1),t.\u0275\u0275advance(),t.\u0275\u0275repeater(t.\u0275\u0275pipeBind1(13,10,a.packagesList)),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,12,"lang.updateInformations")))},dependencies:[ut.MatLegacyTooltip,b.MatLegacyButton,U.MatGridList,U.MatGridTile,M.MatLine,F.MatIcon,v.MatLegacyList,v.MatLegacyListItem,v.MatLegacyListIconCssMatStyler,v.MatLegacyListSubheaderCssMatStyler,gt.M,ht.KeyValuePipe,d.D9],styles:['.stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.packageItem[_ngcontent-%COMP%]{flex:1!important}.iconCheckPackage[_ngcontent-%COMP%]{background:#fff;font-size:15px!important;display:flex;align-items:center;justify-content:center;padding:10px;border-radius:20px;height:35px;width:35px}.icon_ok[_ngcontent-%COMP%]{color:green}.icon_ok[_ngcontent-%COMP%]:before{content:"\\f111"}.icon_warning[_ngcontent-%COMP%]{color:orange}.icon_warning[_ngcontent-%COMP%]:before{content:"\\f111"}.icon_ko[_ngcontent-%COMP%]{color:red}.icon_ko[_ngcontent-%COMP%]:before{content:"\\f111"}.link[_ngcontent-%COMP%]{text-decoration:underline;color:var(--maarch-color-primary)!important}.packageName[_ngcontent-%COMP%]{font-size:120%!important;white-space:normal!important}.packageName[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:help;opacity:.5;color:var(--maarch-color-primary)}  .tooltip-ko{background:#b71c1c;font-size:14px}  .tooltip-warning{background:orange;font-size:14px}']})}}return n})();var G=s(24641);function St(n,l){1&n&&(t.\u0275\u0275elementStart(0,"div",12),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(2,1,"lang.stepEmptyDb")," "))}function It(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"mat-option",15),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=l.$implicit;t.\u0275\u0275property("value",e),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",e," ")}}let _t=(()=>{class n{constructor(e,r,a,i,p,c){this.translate=e,this.http=r,this._formBuilder=a,this.notify=i,this.functionsService=p,this.installerService=c,this.nextStep=new t.EventEmitter,this.hide=!0,this.connectionState=!1,this.dbExist=!1,this.dataFiles=[];const g=[o.Validators.pattern(/^[^;" \\]+$/),o.Validators.required],x=[o.Validators.pattern(/^[^ ]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({dbHostCtrl:["localhost",o.Validators.required],dbLoginCtrl:["",x],dbPortCtrl:["5432",o.Validators.required],dbPasswordCtrl:["",x],dbNameCtrl:["",g],dbSampleCtrl:["data_fr",o.Validators.required],stateStep:["",o.Validators.required]})}ngOnInit(){this.stepFormGroup.controls.dbHostCtrl.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbLoginCtrl.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbPortCtrl.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbPasswordCtrl.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.stepFormGroup.controls.dbNameCtrl.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe(),this.getDataFiles()}getDataFiles(){this.http.get("../rest/installer/sqlDataFiles").pipe((0,m.M)(e=>{this.dataFiles=e.dataFiles}),(0,f.W)(e=>(this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}isValidConnection(){return!1}initStep(){this.installerService.isStepAlreadyLaunched("database")&&this.stepFormGroup.disable()}checkConnection(){this.http.get("../rest/installer/databaseConnection",{observe:"response",params:{server:this.stepFormGroup.controls.dbHostCtrl.value,port:this.stepFormGroup.controls.dbPortCtrl.value,user:this.stepFormGroup.controls.dbLoginCtrl.value,password:this.stepFormGroup.controls.dbPasswordCtrl.value,name:this.stepFormGroup.controls.dbNameCtrl.value}}).pipe((0,m.M)(r=>{this.dbExist=200===r.status,this.notify.success(this.translate.instant("lang.rightInformations")),this.stepFormGroup.controls.stateStep.setValue("success"),this.nextStep.emit()}),(0,f.W)(r=>(this.dbExist=!1,this.notify.error(this.translate.instant("Given database has tables"===r.error.errors?"lang.dbNotEmpty":"lang.badInformations")),this.stepFormGroup.markAllAsTouched(),this.stepFormGroup.controls.stateStep.setValue(""),(0,h.of)(!1)))).subscribe()}checkStep(){return this.stepFormGroup.valid}isValidStep(){return!!this.installerService.isStepAlreadyLaunched("database")||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}isEmptyConnInfo(){return this.stepFormGroup.controls.dbHostCtrl.invalid||this.stepFormGroup.controls.dbPortCtrl.invalid||this.stepFormGroup.controls.dbLoginCtrl.invalid||this.stepFormGroup.controls.dbPasswordCtrl.invalid||this.stepFormGroup.controls.dbNameCtrl.invalid}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("database")||this.stepFormGroup}getInfoToInstall(){return[{idStep:"database",body:{server:this.stepFormGroup.controls.dbHostCtrl.value,port:this.stepFormGroup.controls.dbPortCtrl.value,user:this.stepFormGroup.controls.dbLoginCtrl.value,password:this.stepFormGroup.controls.dbPasswordCtrl.value,name:this.stepFormGroup.controls.dbNameCtrl.value,data:this.stepFormGroup.controls.dbSampleCtrl.value},route:{method:"POST",url:"../rest/installer/database"},description:this.translate.instant("lang.stepDatabaseActionDesc"),installPriority:2}]}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(E.b),t.\u0275\u0275directiveInject(I))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-database"]],outputs:{nextStep:"nextStep"},standalone:!1,decls:48,vars:34,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fa","fa-database"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","dbHostCtrl","required",""],["matInput","","formControlName","dbPortCtrl","required",""],["matInput","","formControlName","dbLoginCtrl","required",""],["matInput","","formControlName","dbPasswordCtrl","required","",3,"type"],["mat-icon-button","","matSuffix","",2,"color","#3A7C00",3,"click"],["matInput","","formControlName","dbNameCtrl","maxlength","50","required",""],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","0px","min-width","100%"],["appearance","outline","floatLabel","never"],["formControlName","dbSampleCtrl"],[3,"value"],[2,"text-align","center"],["mat-raised-button","","type","button",1,"primary",3,"click","disabled"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-form-field",5)(15,"mat-label"),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(18,"input",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(19,"mat-form-field",5)(20,"mat-label"),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(23,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"mat-form-field",5)(25,"mat-label"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"input",9),t.\u0275\u0275elementStart(29,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(30,"mat-icon"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(31,"mat-form-field",5)(32,"mat-label"),t.\u0275\u0275text(33),t.\u0275\u0275pipe(34,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(35,"input",11),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(36,St,3,3,"div",12),t.\u0275\u0275elementStart(37,"mat-form-field",13)(38,"mat-label"),t.\u0275\u0275text(39),t.\u0275\u0275pipe(40,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"mat-select",14),t.\u0275\u0275repeaterCreate(42,It,2,2,"mat-option",15,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(44,"div",16)(45,"button",17),t.\u0275\u0275listener("click",function(){return a.checkConnection()}),t.\u0275\u0275text(46),t.\u0275\u0275pipe(47,"translate"),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,16,"lang.database"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,18,"lang.stepDatabase_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,20,"lang.host")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,22,"lang.port")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(22,24,"lang.user")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(27,26,"lang.password")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(34,28,"lang.dbName")),t.\u0275\u0275advance(3),t.\u0275\u0275conditional(a.dbExist?36:-1),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(40,30,"lang.dbSample")),t.\u0275\u0275advance(3),t.\u0275\u0275repeater(a.dataFiles),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",a.isEmptyConnInfo()||a.stepFormGroup.controls.dbHostCtrl.disabled),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(47,32,"lang.checkInformations")," "))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.RequiredValidator,o.MaxLengthValidator,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,D.MatLegacySelect,z.MatLegacyOption,G.MatLegacyInput,b.MatLegacyButton,F.MatIcon,d.D9],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}}return n})(),xt=(()=>{class n{constructor(e,r,a,i,p){this.translate=e,this._formBuilder=r,this.notify=a,this.http=i,this.installerService=p,this.nextStep=new t.EventEmitter;const c=[o.Validators.pattern(/^[^'<>|*:?]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({docserversPath:["/var/docservers/",c],stateStep:["",o.Validators.required]}),this.stepFormGroup.controls.docserversPath.valueChanges.pipe((0,m.M)(()=>this.stepFormGroup.controls.stateStep.setValue(""))).subscribe()}isValidStep(){return!!this.installerService.isStepAlreadyLaunched("docserver")||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}initStep(){this.installerService.isStepAlreadyLaunched("docserver")&&this.stepFormGroup.disable()}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("docserver")||this.stepFormGroup}checkAvailability(){this.http.get("../rest/installer/docservers",{params:{path:this.stepFormGroup.controls.docserversPath.value}}).pipe((0,m.M)(()=>{this.notify.success(this.translate.instant("lang.rightInformations")),this.stepFormGroup.controls.stateStep.setValue("success"),this.nextStep.emit()}),(0,f.W)(()=>(this.notify.error(this.translate.instant("lang.pathUnreachable")),this.stepFormGroup.controls.stateStep.setValue(""),(0,h.of)(!1)))).subscribe()}getInfoToInstall(){return[{idStep:"docserver",body:{path:this.stepFormGroup.controls.docserversPath.value},route:{method:"POST",url:"../rest/installer/docservers"},description:this.translate.instant("lang.stepDocserversActionDesc"),installPriority:3}]}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(I))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-docservers"]],outputs:{nextStep:"nextStep"},standalone:!1,decls:20,vars:14,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fa","fa-hdd"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline",2,"color","initial"],["matInput","","formControlName","docserversPath"],["matSuffix",""],[2,"text-align","center"],["mat-raised-button","","type","button",1,"primary",3,"click","disabled"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementStart(14,"span",7),t.\u0275\u0275text(15,"/__CUSTOM_iD__/"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(16,"div",8)(17,"button",9),t.\u0275\u0275listener("click",function(){return a.checkAvailability()}),t.\u0275\u0275text(18),t.\u0275\u0275pipe(19,"translate"),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,6,"lang.docserver"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,8,"lang.stepDocserver_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,10,"lang.docserverPath")),t.\u0275\u0275advance(6),t.\u0275\u0275property("disabled",!a.stepFormGroup.controls.docserversPath.valid),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(19,12,"lang.checkInformations")))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,G.MatLegacyInput,b.MatLegacyButton,d.D9],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}}return n})();var q=s(89524),Ft=s(99172),Mt=s(70152),Et=s(15486),Gt=s(96045);const Lt=()=>({value1:'"_", "-"'}),Bt=()=>({value1:"2"});function kt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(1,1,"lang.customAlreadyExist")," ")}function Tt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(1,1,"lang.invalidCustomName")," ")}function Pt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(1,1,"lang.onlySpecialCharAllowed",t.\u0275\u0275pureFunction0(4,Lt))," ")}function Vt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(1,1,"lang.invalidLengthCustomName",t.\u0275\u0275pureFunction0(4,Bt))," ")}function wt(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-card",20),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(e).$implicit,i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.selectBg(a.url))}),t.\u0275\u0275elementEnd()}if(2&n){const e=l.$implicit,r=t.\u0275\u0275nextContext();t.\u0275\u0275styleProp("background","url("+e.url+")"),t.\u0275\u0275classProp("selected",e.url===r.stepFormGroup.controls.bodyLoginBackground.value)("disabled",r.stepFormGroup.controls.bodyLoginBackground.disabled)}}function At(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-card",21),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275reference(2);return t.\u0275\u0275resetView(a.click())}),t.\u0275\u0275elementStart(1,"input",22,1),t.\u0275\u0275listener("change",function(a){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.uploadTrigger(a,"bg"))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(3,"i",23),t.\u0275\u0275elementEnd()}}let jt=(()=>{class n{constructor(e,r,a,i,p,c,g,x){this.translate=e,this._formBuilder=r,this.notify=a,this.sanitizer=i,this.scanPipe=p,this.http=c,this.installerService=g,this.functionsService=x,this.readonlyState=!1,this.backgroundList=[];const V=[o.Validators.pattern(/^[a-z0-9_-]*$/),o.Validators.required,o.Validators.minLength(3)],L=this.functionsService.getDocBaseUrl(),ee=this.functionsService.getTutorialBaseUrl();this.stepFormGroup=this._formBuilder.group({firstCtrl:["success",o.Validators.required],customId:[null,V],appName:[`MEM Courrier ${P.c.BASE_VERSION}`,o.Validators.required],loginMessage:[`<span style="color:#3A7C00"><strong>D\xe9couvrez votre application via</strong></span>&nbsp;<a title="le guide de visite" href="${L}" target="_blank"><span style="color:#C25712;"><strong>le guide de visite en ligne</strong></span></a>`],homeMessage:[`<p>Bienvenue sur <strong>MEM Courrier ${P.c.BASE_VERSION}.</strong><br/> Suivez le <a title="guide de visite en ligne" href="${L}" target="_blank"><span style="color:#FFFD94;"><strong>guide de visite en ligne</strong></span></a>.<br/> Visitez nos <a title="Tutoriels MEM Courrier" href="${ee}" target="_blank"><span style="color:#FFFD94;"><strong>tutoriels MEM courrier</strong></span></a>.</p>`],bodyLoginBackground:["assets/bodylogin.jpg"],uploadedLogo:["../rest/images?image=logo"]}),this.backgroundList=Array.from({length:17}).map((re,R)=>({filename:`${R+1}.jpg`,url:`assets/${R+1}.jpg`}))}ngOnInit(){this.checkCustomExist(),this.stepFormGroup.controls.customId.valueChanges.pipe((0,Ft.Z)(""),(0,m.M)(()=>{this.stepFormGroup.controls.firstCtrl.setValue("")}),(0,Mt.B)(500),(0,T.p)(e=>e.length>2),(0,T.p)(()=>null===this.stepFormGroup.controls.customId.errors||void 0===this.stepFormGroup.controls.customId.errors.pattern),(0,m.M)(()=>{this.checkCustomExist()})).subscribe()}initStep(){null===this.stepFormGroup.controls.customId.value&&this.stepFormGroup.controls.customId.setValue(this.appDatabase.getInfoToInstall()[0].body.name),this.installerService.isStepAlreadyLaunched("createCustom")&&this.installerService.isStepAlreadyLaunched("customization")?(this.stepFormGroup.disable(),this.readonlyState=!0,tinymce.remove(),this.initMce(!0)):this.installerService.isStepAlreadyLaunched("createCustom")?(this.stepFormGroup.controls.customId.disable(),this.stepFormGroup.controls.appName.disable(),this.stepFormGroup.controls.firstCtrl.disable()):this.installerService.isStepAlreadyLaunched("customization")?(this.stepFormGroup.controls.loginMessage.disable(),this.stepFormGroup.controls.homeMessage.disable(),this.stepFormGroup.controls.bodyLoginBackground.disable(),this.stepFormGroup.controls.uploadedLogo.disable(),this.readonlyState=!0,tinymce.remove(),this.initMce(!0)):(this.readonlyState=!1,this.initMce())}checkCustomExist(){this.http.get("../rest/installer/custom",{observe:"response",params:{customId:this.stepFormGroup.controls.customId.value}}).pipe((0,m.M)(()=>{null!==this.stepFormGroup.controls.customId.errors?delete this.stepFormGroup.controls.customId.errors.customExist:this.stepFormGroup.controls.firstCtrl.setValue("success")}),(0,f.W)(e=>(null!==e.error.errors.match(/^Custom already exists/g)?(this.stepFormGroup.controls.customId.setErrors({...this.stepFormGroup.controls.customId.errors,customExist:!0}),this.stepFormGroup.controls.customId.markAsTouched()):null!==e.error.errors.match(/^Unauthorized custom name/g)?(this.stepFormGroup.controls.customId.setErrors({...this.stepFormGroup.controls.customId.errors,invalidCustomName:!0}),this.stepFormGroup.controls.customId.markAsTouched()):this.notify.handleSoftErrors(e),(0,h.of)(!1)))).subscribe()}isValidStep(){return!(!this.installerService.isStepAlreadyLaunched("createCustom")||!this.installerService.isStepAlreadyLaunched("customization"))||void 0!==this.stepFormGroup&&this.stepFormGroup.valid}getFormGroup(){return!(!this.installerService.isStepAlreadyLaunched("createCustom")||!this.installerService.isStepAlreadyLaunched("customization"))||this.stepFormGroup}initMce(e=!1){tinymce.init({selector:"textarea",base_url:"../dist/tinymce/",convert_urls:!1,height:"150",suffix:".min",language:this.translate.instant("lang.langISO").replace("-","_"),language_url:`../node_modules/tinymce-i18n/langs${tinymce.majorVersion>=5?tinymce.majorVersion:""}/${this.translate.instant("lang.langISO").replace("-","_")}.js`,menubar:!1,statusbar:!1,readonly:e,plugins:["autolink"],extended_valid_elements:"script[src|async|defer|type|charset]",external_plugins:{maarch_b64image:"../tinymce/maarch_b64image/plugin.min.js"},toolbar_sticky:!0,toolbar_mode:"floating",toolbar:e?"":"undo redo | fontselect fontsizeselect | bold italic underline strikethrough forecolor | maarch_b64image |         alignleft aligncenter alignright alignjustify         bullist numlist outdent indent | removeformat"})}getInfoToInstall(){return[{idStep:"createCustom",body:{lang:this.appWelcome.stepFormGroup.controls.lang.value,customId:this.stepFormGroup.controls.customId.value,applicationName:this.stepFormGroup.controls.appName.value},description:this.translate.instant("lang.stepInstanceActionDesc"),route:{method:"POST",url:"../rest/installer/custom"},installPriority:1},{idStep:"customization",body:{loginMessage:tinymce.get("loginMessage").getContent(),homeMessage:tinymce.get("homeMessage").getContent(),bodyLoginBackground:this.stepFormGroup.controls.bodyLoginBackground.value,logo:this.stepFormGroup.controls.uploadedLogo.value},description:this.translate.instant("lang.stepCustomizationActionDesc"),route:{method:"POST",url:"../rest/installer/customization"},installPriority:3}]}uploadTrigger(e,r){if(e.target.files&&e.target.files[0]){const a=this.canUploadFile(e.target.files[0],r);if(!0===a){const i=new FileReader;i.readAsDataURL(e.target.files[0]),i.onload=p=>{if("logo"===r)this.stepFormGroup.controls.uploadedLogo.setValue(p.target.result);else{const c=new Image;c.onload=g=>{g.target.width<1920||g.target.height<1080?this.notify.error(this.translate.instant("lang.badImageResolution",{value1:"1920x1080"})):(this.backgroundList.push({filename:p.target.result,url:p.target.result}),this.stepFormGroup.controls.bodyLoginBackground.setValue(p.target.result))},c.src=p.target.result}}}else this.notify.error(a)}}canUploadFile(e,r){const a="logo"!==r?["image/jpg","image/jpeg"]:["image/svg+xml"];if("logo"===r){if(e.size>5e6)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"5mo"});if(-1===a.indexOf(e.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:a.join(", ")})}else{if(e.size>1e7)return this.translate.instant("lang.maxFileSizeExceeded",{value1:"10mo"});if(-1===a.indexOf(e.type))return this.translate.instant("lang.onlyExtensionsAllowed",{value1:a.join(", ")})}return!0}logoURL(){return this.sanitizer.bypassSecurityTrustUrl(this.stepFormGroup.controls.uploadedLogo.value)}selectBg(e){this.stepFormGroup.controls.bodyLoginBackground.disabled||this.stepFormGroup.controls.bodyLoginBackground.setValue(e)}clickLogoButton(e){this.stepFormGroup.controls.uploadedLogo.disabled||e.click()}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(Et.DomSanitizer),t.\u0275\u0275directiveInject(q.Ef),t.\u0275\u0275directiveInject(S.HttpClient),t.\u0275\u0275directiveInject(I),t.\u0275\u0275directiveInject(E.b))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-customization"]],inputs:{appDatabase:"appDatabase",appWelcome:"appWelcome"},standalone:!1,features:[t.\u0275\u0275ProvidersFeature([q.Ef])],decls:55,vars:35,consts:[["uploadLogo",""],["uploadFile",""],[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-tools"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"display","contents",3,"formGroup"],[1,"col-md-6"],["appearance","outline"],["matInput","","formControlName","customId"],["matInput","","formControlName","appName"],["name","loginMessage","id","loginMessage","formControlName","loginMessage",2,"padding-top","10px"],["name","homeMessage","id","homeMessage","formControlName","homeMessage",2,"padding-top","10px"],["matRipple","",2,"width","350px","background-size","100%","cursor","pointer"],[2,"width","100%",3,"click","src"],["type","file","name","files[]","accept","image/svg+xml",2,"display","none",3,"change"],[1,"backgroundList"],[1,"backgroundItem",2,"background","url(assets/bodylogin.jpg)","background-size","cover","opacity","0.3",3,"click"],[1,"backgroundItem",2,"opacity","0.3",3,"selected","disabled","background"],[1,"backgroundItem",2,"opacity","0.3","display","flex","align-items","center","justify-content","center"],[1,"backgroundItem",2,"opacity","0.3",3,"click"],[1,"backgroundItem",2,"opacity","0.3","display","flex","align-items","center","justify-content","center",3,"click"],["type","file","name","files[]","accept","image/jpeg",2,"display","none",3,"change"],[1,"fa","fa-plus",2,"font-size","30px","color","#666"]],template:function(r,a){if(1&r){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",2)(1,"h2",3),t.\u0275\u0275element(2,"i",4),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",5),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",6)(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),t.\u0275\u0275text(12),t.\u0275\u0275pipe(13,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(14,"input",9),t.\u0275\u0275elementStart(15,"mat-error"),t.\u0275\u0275template(16,kt,2,3)(17,Tt,2,3)(18,Pt,2,5)(19,Vt,2,5),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(20,"mat-form-field",8)(21,"mat-label"),t.\u0275\u0275text(22),t.\u0275\u0275pipe(23,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(24,"input",10),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(25,"div"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"textarea",11)(29,"br")(30,"br"),t.\u0275\u0275elementStart(31,"div"),t.\u0275\u0275text(32),t.\u0275\u0275pipe(33,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(34,"textarea",12)(35,"br")(36,"br"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(37,"div",7)(38,"div"),t.\u0275\u0275text(39),t.\u0275\u0275pipe(40,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"div")(42,"mat-card",13)(43,"img",14),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const c=t.\u0275\u0275reference(45);return t.\u0275\u0275resetView(a.clickLogoButton(c))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(44,"input",15,0),t.\u0275\u0275listener("change",function(c){return t.\u0275\u0275restoreView(i),t.\u0275\u0275resetView(a.uploadTrigger(c,"logo"))}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275element(46,"br"),t.\u0275\u0275elementStart(47,"div"),t.\u0275\u0275text(48),t.\u0275\u0275pipe(49,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(50,"div",16)(51,"mat-card",17),t.\u0275\u0275listener("click",function(){return t.\u0275\u0275restoreView(i),t.\u0275\u0275resetView(a.selectBg("assets/bodylogin.jpg"))}),t.\u0275\u0275elementEnd(),t.\u0275\u0275repeaterCreate(52,wt,1,6,"mat-card",18,t.\u0275\u0275repeaterTrackByIdentity),t.\u0275\u0275template(54,At,4,0,"mat-card",19),t.\u0275\u0275elementEnd()()()()}2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,19,"lang.customization"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,21,"lang.stepCustomization_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(13,23,"lang.instanceId")),t.\u0275\u0275advance(4),t.\u0275\u0275conditional(null!=a.stepFormGroup.controls.customId.errors&&a.stepFormGroup.controls.customId.errors.customExist?16:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional(null!=a.stepFormGroup.controls.customId.errors&&a.stepFormGroup.controls.customId.errors.invalidCustomName?17:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional(null!=a.stepFormGroup.controls.customId.errors&&a.stepFormGroup.controls.customId.errors.pattern?18:-1),t.\u0275\u0275advance(),t.\u0275\u0275conditional(null!=a.stepFormGroup.controls.customId.errors&&a.stepFormGroup.controls.customId.errors.minlength?19:-1),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(23,25,"lang.applicationName")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(27,27,"lang.loginMsg")," : "),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(33,29,"lang.homeMsg")," : "),t.\u0275\u0275advance(7),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(40,31,"lang.chooseLogo")," : "),t.\u0275\u0275advance(4),t.\u0275\u0275property("src",a.logoURL(),t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate1("",t.\u0275\u0275pipeBind1(49,33,"lang.chooseLoginBg")," : "),t.\u0275\u0275advance(3),t.\u0275\u0275classProp("disabled",a.stepFormGroup.controls.bodyLoginBackground.disabled)("selected","assets/bodylogin.jpg"===a.stepFormGroup.controls.bodyLoginBackground.value),t.\u0275\u0275advance(),t.\u0275\u0275repeater(a.backgroundList),t.\u0275\u0275advance(2),t.\u0275\u0275conditional(a.stepFormGroup.controls.bodyLoginBackground.disabled?-1:54))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyError,u.MatLegacyFormField,u.MatLegacyLabel,G.MatLegacyInput,Gt.MatLegacyCard,M.MatRipple,d.D9],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}.backgroundList[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);grid-gap:10px}.selected[_ngcontent-%COMP%]{transition:all .3s;opacity:1!important;border:solid 10px var(--maarch-color-secondary)!important}.backgroundItem[_ngcontent-%COMP%]{border:solid 0px var(--maarch-color-secondary);opacity:.5;transition:all .3s;cursor:pointer;height:120px;background-size:cover!important}.disabled[_ngcontent-%COMP%]{cursor:default!important}.backgroundItem[_ngcontent-%COMP%]:not(.disabled):hover{transition:all .3s;opacity:1!important}"]})}}return n})(),Ot=(()=>{class n{constructor(e,r,a,i){this.translate=e,this._formBuilder=r,this.notify=a,this.installerService=i,this.tiggerInstall=new t.EventEmitter,this.hide=!0;const p=[o.Validators.pattern(/^[\w.@-]*$/),o.Validators.required],c=[o.Validators.pattern(/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/),o.Validators.required];this.stepFormGroup=this._formBuilder.group({login:["superadmin",p],firstname:["Admin",o.Validators.required],lastname:["SUPER",o.Validators.required],password:["",o.Validators.required],passwordConfirm:["",o.Validators.required],email:["yourEmail@domain.com",c]})}ngOnInit(){this.stepFormGroup.controls.password.valueChanges.pipe((0,m.M)(e=>{e!==this.stepFormGroup.controls.passwordConfirm.value?(this.stepFormGroup.controls.password.setErrors({incorrect:!0}),this.stepFormGroup.controls.passwordConfirm.setErrors({incorrect:!0}),this.stepFormGroup.controls.passwordConfirm.markAsTouched()):(this.stepFormGroup.controls.password.setErrors(null),this.stepFormGroup.controls.passwordConfirm.setErrors(null))})).subscribe(),this.stepFormGroup.controls.passwordConfirm.valueChanges.pipe((0,m.M)(e=>{e!==this.stepFormGroup.controls.password.value?(this.stepFormGroup.controls.password.setErrors({incorrect:!0}),this.stepFormGroup.controls.password.markAsTouched(),this.stepFormGroup.controls.passwordConfirm.setErrors({incorrect:!0})):(this.stepFormGroup.controls.password.setErrors(null),this.stepFormGroup.controls.passwordConfirm.setErrors(null))})).subscribe()}initStep(){this.installerService.isStepAlreadyLaunched("userAdmin")&&this.stepFormGroup.disable()}isValidStep(){return void 0!==this.stepFormGroup&&(this.stepFormGroup.valid||this.installerService.isStepAlreadyLaunched("userAdmin"))}getFormGroup(){return!!this.installerService.isStepAlreadyLaunched("userAdmin")||this.stepFormGroup}getInfoToInstall(){return[{idStep:"userAdmin",body:{login:this.stepFormGroup.controls.login.value,firstname:this.stepFormGroup.controls.firstname.value,lastname:this.stepFormGroup.controls.lastname.value,password:this.stepFormGroup.controls.password.value,email:this.stepFormGroup.controls.email.value},route:{method:"PUT",url:"../rest/installer/administrator"},description:this.translate.instant("lang.stepUserAdminActionDesc"),installPriority:3}]}launchInstall(){this.tiggerInstall.emit()}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(o.UntypedFormBuilder),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(I))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-useradmin"]],outputs:{tiggerInstall:"tiggerInstall"},standalone:!1,decls:49,vars:39,consts:[[1,"stepContent"],[1,"stepContentTitle"],[1,"fas","fa-user"],["role","alert",1,"alert-message","alert-message-info",2,"margin-top","30px","min-width","100%"],[2,"width","850px","margin","auto",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","login"],["matInput","","formControlName","firstname"],["matInput","","formControlName","lastname"],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","",2,"color","#3A7C00",3,"click"],["matInput","","formControlName","passwordConfirm",3,"type"],["matInput","","formControlName","email"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275element(2,"i",2),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",3),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),t.\u0275\u0275text(11),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(13,"input",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"mat-form-field",5)(15,"mat-label"),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(18,"input",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(19,"mat-form-field",5)(20,"mat-label"),t.\u0275\u0275text(21),t.\u0275\u0275pipe(22,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(23,"input",8),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(24,"mat-form-field",5)(25,"mat-label"),t.\u0275\u0275text(26),t.\u0275\u0275pipe(27,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(28,"input",9),t.\u0275\u0275elementStart(29,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(30,"mat-icon"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(31,"mat-error"),t.\u0275\u0275text(32),t.\u0275\u0275pipe(33,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(34,"mat-form-field",5)(35,"mat-label"),t.\u0275\u0275text(36),t.\u0275\u0275pipe(37,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(38,"input",11),t.\u0275\u0275elementStart(39,"button",10),t.\u0275\u0275listener("click",function(){return a.hide=!a.hide}),t.\u0275\u0275element(40,"mat-icon"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(41,"mat-error"),t.\u0275\u0275text(42),t.\u0275\u0275pipe(43,"translate"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(44,"mat-form-field",5)(45,"mat-label"),t.\u0275\u0275text(46),t.\u0275\u0275pipe(47,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(48,"input",12),t.\u0275\u0275elementEnd()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,19,"lang.userAdmin"),""),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,21,"lang.stepUserAdmin_desc")," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("formGroup",a.stepFormGroup),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(12,23,"lang.id")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(17,25,"lang.firstname")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(22,27,"lang.lastname")),t.\u0275\u0275advance(5),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(27,29,"lang.password")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(33,31,"lang.passwordNotMatch")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(37,33,"lang.retypeNewPassword")),t.\u0275\u0275advance(2),t.\u0275\u0275property("type",a.hide?"password":"text"),t.\u0275\u0275advance(2),t.\u0275\u0275classMapInterpolate1("fa ",a.hide?"fa-eye-slash":"fa-eye",""),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(43,35,"lang.passwordNotMatch")),t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(47,37,"lang.email")))},dependencies:[o.\u0275NgNoValidate,o.DefaultValueAccessor,o.NgControlStatus,o.NgControlStatusGroup,o.FormGroupDirective,o.FormControlName,u.MatLegacyError,u.MatLegacyFormField,u.MatLegacyLabel,u.MatLegacySuffix,G.MatLegacyInput,b.MatLegacyButton,F.MatIcon,d.D9],styles:[".stepContent[_ngcontent-%COMP%]{margin:auto}.stepContent[_ngcontent-%COMP%]   .stepContentTitle[_ngcontent-%COMP%]{color:var(--maarch-color-primary);margin-bottom:30px;border-bottom:solid 1px;padding:0}"]})}}return n})();const Nt=["stepper"],Dt=["stepContent"];function zt(n,l){1&n&&t.\u0275\u0275text(0,"Installation")}function Ut(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",33),t.\u0275\u0275pipe(1,"translate"),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.gotToLogin())}),t.\u0275\u0275element(2,"mat-icon",34),t.\u0275\u0275elementEnd()}2&n&&t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(1,1,"lang.home"))}function $t(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.prerequisite"))}function qt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.database"))}function Rt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.docserver"))}function Wt(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.customization"))}function Ht(n,l){1&n&&(t.\u0275\u0275text(0),t.\u0275\u0275pipe(1,"translate")),2&n&&t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(1,1,"lang.userAdmin"))}function Qt(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",35)}function Kt(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",35)}function Jt(n,l){1&n&&t.\u0275\u0275element(0,"mat-icon",36)}function Zt(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"mat-horizontal-stepper",13,0),t.\u0275\u0275listener("selectionChange",function(a){t.\u0275\u0275restoreView(e);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.initStep(a))}),t.\u0275\u0275elementStart(2,"mat-step",14),t.\u0275\u0275template(3,zt,1,0,"ng-template",15),t.\u0275\u0275elementStart(4,"div",16)(5,"div",17),t.\u0275\u0275element(6,"app-welcome",null,1),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,Ut,3,3,"button",18),t.\u0275\u0275elementStart(10,"button",19),t.\u0275\u0275pipe(11,"translate"),t.\u0275\u0275element(12,"mat-icon",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(13,"mat-step",21),t.\u0275\u0275template(14,$t,2,3,"ng-template",15),t.\u0275\u0275elementStart(15,"div",16)(16,"div",17),t.\u0275\u0275element(17,"app-prerequisite",null,2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(20,"button",22),t.\u0275\u0275pipe(21,"translate"),t.\u0275\u0275element(22,"mat-icon",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(23,"button",24),t.\u0275\u0275pipe(24,"translate"),t.\u0275\u0275element(25,"mat-icon",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(26,"mat-step",21),t.\u0275\u0275template(27,qt,2,3,"ng-template",15),t.\u0275\u0275elementStart(28,"div",16)(29,"div",17)(30,"app-database",25,3),t.\u0275\u0275listener("nextStep",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.nextStep())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(33,"button",22),t.\u0275\u0275pipe(34,"translate"),t.\u0275\u0275element(35,"mat-icon",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(36,"button",24),t.\u0275\u0275pipe(37,"translate"),t.\u0275\u0275element(38,"mat-icon",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(39,"mat-step",21),t.\u0275\u0275template(40,Rt,2,3,"ng-template",15),t.\u0275\u0275elementStart(41,"div",16)(42,"div",17)(43,"app-docservers",25,4),t.\u0275\u0275listener("nextStep",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.nextStep())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(46,"button",22),t.\u0275\u0275pipe(47,"translate"),t.\u0275\u0275element(48,"mat-icon",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(49,"button",24),t.\u0275\u0275pipe(50,"translate"),t.\u0275\u0275element(51,"mat-icon",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(52,"mat-step",21),t.\u0275\u0275template(53,Wt,2,3,"ng-template",15),t.\u0275\u0275elementStart(54,"div",16)(55,"div",17),t.\u0275\u0275element(56,"app-customization",26,5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(59,"button",22),t.\u0275\u0275pipe(60,"translate"),t.\u0275\u0275element(61,"mat-icon",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(62,"button",24),t.\u0275\u0275pipe(63,"translate"),t.\u0275\u0275element(64,"mat-icon",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(65,"mat-step",21),t.\u0275\u0275template(66,Ht,2,3,"ng-template",15),t.\u0275\u0275elementStart(67,"div",16)(68,"div",17)(69,"app-useradmin",27,6),t.\u0275\u0275listener("tiggerInstall",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.endInstall())}),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(72,"button",22),t.\u0275\u0275pipe(73,"translate"),t.\u0275\u0275element(74,"mat-icon",23),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(75,"button",28),t.\u0275\u0275pipe(76,"translate"),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.endInstall())}),t.\u0275\u0275element(77,"mat-icon",29),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275template(78,Qt,1,0,"ng-template",30)(79,Kt,1,0,"ng-template",31)(80,Jt,1,0,"ng-template",32),t.\u0275\u0275elementEnd()}if(2&n){const e=t.\u0275\u0275reference(8),r=t.\u0275\u0275reference(18),a=t.\u0275\u0275reference(31),i=t.\u0275\u0275reference(44),p=t.\u0275\u0275reference(57),c=t.\u0275\u0275reference(70),g=t.\u0275\u0275nextContext();t.\u0275\u0275property("@.disabled",!0),t.\u0275\u0275advance(9),t.\u0275\u0275conditional(g.authService.noInstall?-1:9),t.\u0275\u0275advance(),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(11,25,"lang.next")),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",r.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(21,27,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(24,29,"lang.next"))("disabled",!r.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",a.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(34,31,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(37,33,"lang.next"))("disabled",!a.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",i.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(47,35,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(50,37,"lang.next"))("disabled",!i.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",p.getFormGroup()),t.\u0275\u0275advance(4),t.\u0275\u0275property("appDatabase",a)("appWelcome",e),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(60,39,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(63,41,"lang.next"))("disabled",!p.isValidStep()),t.\u0275\u0275advance(3),t.\u0275\u0275property("stepControl",c.getFormGroup()),t.\u0275\u0275advance(7),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(73,43,"lang.previous")),t.\u0275\u0275advance(3),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(76,45,"lang.beginInstall"))("disabled",!c.isValidStep())}}const Yt=[{path:"",component:(()=>{class n{constructor(e,r,a,i,p,c,g,x,V,L){this.translate=e,this.router=r,this.headerService=a,this.notify=i,this.appService=p,this.sortPipe=c,this.dialog=g,this.functionService=x,this.privilegeService=V,this.authService=L,this.loading=!0}ngOnInit(){this.headerService.hideSideBar=!0,this.authService.isAuth()||this.authService.noInstall?null===this.authService.getToken()||this.privilegeService.hasCurrentUserPrivilege("create_custom")?this.loading=!1:(this.router.navigate(["/login"]),this.notify.error(this.translate.instant("lang.mustPrivilegeToInstall"))):(this.router.navigate(["/login"]),this.notify.error(this.translate.instant("lang.mustConnectToInstall")))}ngAfterViewInit(){$(".mat-horizontal-stepper-header-container").insertBefore(".bg-head-content"),$(".mat-step-icon").css("background-color","white"),$(".mat-step-icon").css("color","#3A7C00"),$(".mat-step-label").css("color","white")}isValidStep(){return!1}initStep(e){this.stepContent.toArray()[e.selectedIndex].initStep()}nextStep(){this.stepper.next()}gotToLogin(){this.router.navigate(["/login"])}endInstall(){let e=[];this.stepContent.toArray().forEach(a=>{e=e.concat(a.getInfoToInstall())}),e=this.sortPipe.transform(e,"installPriority"),this.dialog.open(nt,{panelClass:"maarch-modal",disableClose:!0,width:"500px",data:e}).afterClosed().pipe((0,T.p)(a=>!this.functionService.empty(a)),(0,m.M)(()=>{}),(0,f.W)(a=>(this.notify.handleErrors(a),(0,h.of)(!1)))).subscribe()}static{this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(d.c$),t.\u0275\u0275directiveInject(B.Router),t.\u0275\u0275directiveInject(at.d),t.\u0275\u0275directiveInject(C.J),t.\u0275\u0275directiveInject(rt.d),t.\u0275\u0275directiveInject(A.F),t.\u0275\u0275directiveInject(y.MatDialog),t.\u0275\u0275directiveInject(E.b),t.\u0275\u0275directiveInject(ot.f),t.\u0275\u0275directiveInject(k.u))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["ng-component"]],viewQuery:function(r,a){if(1&r&&(t.\u0275\u0275viewQuery(Nt,5),t.\u0275\u0275viewQuery(Dt,5)),2&r){let i;t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.stepper=i.first),t.\u0275\u0275queryRefresh(i=t.\u0275\u0275loadQuery())&&(a.stepContent=i)}},standalone:!1,features:[t.\u0275\u0275ProvidersFeature([{provide:H.STEPPER_GLOBAL_OPTIONS,useValue:{showError:!0}},A.F])],decls:7,vars:5,consts:[["stepper",""],["stepContent","","appWelcome",""],["appPrerequisite","","stepContent",""],["appDatabase","","stepContent",""],["appDocservers","","stepContent",""],["appCustomization","","stepContent",""],["appUseradmin","","stepContent",""],["autosize","",1,"maarch-container"],[1,"bg-head"],[1,"bg-head-content"],[1,"container"],[1,"container-content",2,"overflow","hidden"],["linear","",2,"height","100vh","overflow","auto"],["linear","",2,"height","100vh","overflow","auto",3,"selectionChange"],["label","install"],["matStepLabel",""],[1,"stepContainer"],[1,"stepContent"],["mat-fab","",1,"previousStepButton",2,"color","#3A7C00",3,"title"],["mat-fab","","matStepperNext","",1,"nextStepButton",2,"color","#3A7C00",3,"title"],[1,"fa","fa-arrow-right"],[3,"stepControl"],["mat-fab","","matStepperPrevious","",1,"previousStepButton",2,"color","#3A7C00",3,"title"],[1,"fa","fa-arrow-left"],["mat-fab","","matStepperNext","",1,"nextStepButton",2,"color","#3A7C00",3,"title","disabled"],[3,"nextStep"],[3,"appDatabase","appWelcome"],[3,"tiggerInstall"],["mat-fab","",1,"nextStepButton","accent",3,"click","title","disabled"],[1,"fas","fa-check-double"],["matStepperIcon","edit"],["matStepperIcon","done"],["matStepperIcon","error"],["mat-fab","",1,"previousStepButton",2,"color","#3A7C00",3,"click","title"],[1,"fas","fa-home"],[1,"fa","fa-check","stepIcon"],[1,"fa","fa-times","stepIcon",2,"color","red","font-size","15px !important"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"mat-sidenav-container",7)(1,"mat-sidenav-content")(2,"div",8),t.\u0275\u0275element(3,"div",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",10)(5,"div",11),t.\u0275\u0275template(6,Zt,81,47,"mat-horizontal-stepper",12),t.\u0275\u0275elementEnd()()()()),2&r&&(t.\u0275\u0275advance(3),t.\u0275\u0275classProp("fullContainer",a.appService.getViewMode()),t.\u0275\u0275advance(),t.\u0275\u0275classProp("fullContainer",a.appService.getViewMode()),t.\u0275\u0275advance(2),t.\u0275\u0275conditional(a.loading?-1:6))},dependencies:[N.MatSidenavContainer,N.MatSidenavContent,b.MatLegacyButton,F.MatIcon,_.MatStep,_.MatStepLabel,_.MatStepper,_.MatStepperNext,_.MatStepperPrevious,_.MatStepperIcon,dt,yt,_t,xt,jt,Ot,d.D9],styles:[".mat-stepper-horizontal{height:100%!important}.container[_ngcontent-%COMP%]{padding-left:80px!important;padding-right:80px!important}.previousStepButton[_ngcontent-%COMP%]{position:fixed;top:50%;left:10px;transform:translateY(-50%)}.previousStepButton[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:25px;height:auto;width:auto}.nextStepButton[_ngcontent-%COMP%]{position:fixed;top:50%;right:13px;transform:translateY(-50%)}.nextStepButton[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:25px;height:auto;width:auto}  .mat-step-icon{background-color:#fff;color:var(--maarch-color-primary)}  .mat-step-label-active{opacity:1!important}  .mat-step-label{color:#fff;opacity:.5}.stepIcon[_ngcontent-%COMP%]{font-size:10px!important;height:auto!important;width:auto!important}  .mat-step-label{transition:all .2s}  .mat-step-label-selected{font-size:160%;transition:all .2s;opacity:1}"]})}}return n})()}];let Xt=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=t.\u0275\u0275defineNgModule({type:n})}static{this.\u0275inj=t.\u0275\u0275defineInjector({imports:[B.RouterModule.forChild(Yt),B.RouterModule]})}}return n})(),te=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=t.\u0275\u0275defineNgModule({type:n})}static{this.\u0275inj=t.\u0275\u0275defineInjector({providers:[I],imports:[W.G,d.h,Xt]})}}return n})()}}]);