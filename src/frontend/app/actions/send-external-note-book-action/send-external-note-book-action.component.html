<div class="mat-dialog-content-container">
  <h1 mat-dialog-title>{{data.action.label}}</h1>
  <div mat-dialog-content>
    @if (loading) {
      <div class="loading" style="display:flex;height:100%;">
        <mat-spinner style="margin:auto;"></mat-spinner>
      </div>
    }
    <mat-sidenav-container autosize style="height:100%;">
      <mat-sidenav-content style="background: white;">
        <div class="row" style="margin: 0;">
          <div class="col-md-12">
            {{'lang.makeActionOn' | translate}}
            @if (data.resIds.length === 0) {
              <b
              class="highlight primary">{{'lang.currentIndexingMail' | translate}}</b>
            }
            @if (data.resIds.length === 1) {
              <b
              class="highlight primary">{{data.resource.chrono}}</b>
            }
            @if (data.resIds.length > 1) {
              <b class="primary highlight">{{data.resIds.length}}
              {{'lang.elements' | translate}}</b>
              } ?
            </div>
            <div>
              @if (additionalsInfos.users.length !== 0) {
                <div class="col-md-12" style="padding-top: 10px;">
                  <app-plugin-autocomplete [labelPlaceholder]="'lang.userMaarchParapheur' | translate"
                    [datas]="additionalsInfos.users" [targetSearchKey]="'displayName'" [subInfoKey]="'email'"
                    (triggerEvent)="setVal($event)" [singleMode]="true" appearance="outline">
                  </app-plugin-autocomplete>
                </div>
              }
              @if (additionalsInfos.users.length === 0) {
                <div class="col-md-12">
                  {{'lang.noUserDefinedInMaarchParapheur' | translate}}
                </div>
              }
              @if (additionalsInfos.noMail.length !== 0) {
                <div class="col-md-12">
                  <div>
                    <div class="alert-message alert-message-danger mailList" role="alert">
                      <p>
                        {{'lang.canNotMakeAction' | translate}} :
                      </p>
                      <ul>
                        @for (mail of additionalsInfos.noMail; track mail) {
                          <li>
                            <b>{{mail.alt_identifier}}</b> : {{'lang.' + mail.reason | translate}}
                          </li>
                        }
                      </ul>
                    </div>
                  </div>
                </div>
              }
            </div>
            <div class="col-md-12" style="padding-top: 10px;">
              <app-note-editor #noteEditor [resIds]="data.resIds"></app-note-editor>
            </div>
            @if (showToggle) {
              <div class="col-md-12" style="margin: 10px 0px 10px 0px;">
                <mat-slide-toggle name="history" class="primary"
                  [title]="'lang.canGoToNextResDesc' | translate" [(ngModel)]="canGoToNextRes" [checked]="canGoToNextRes">
                  {{'lang.canGoToNextRes' | translate}}
                </mat-slide-toggle>
              </div>
              <mat-divider></mat-divider>
            }
          </div>
        </mat-sidenav-content>
      </mat-sidenav-container>
    </div>
    <span class="divider-modal"></span>
    <div mat-dialog-actions class="actions">
      <button mat-raised-button mat-button class="primary" [disabled]="loading || checkValidAction()"
      (click)="onSubmit()">{{'lang.validate' | translate}}</button>
      <button mat-raised-button mat-button [disabled]="loading" [mat-dialog-close]="">{{'lang.cancel' | translate}}</button>
    </div>
  </div>
