<mat-form-field [class]="class + ' search-select'" [floatLabel]="appService.getViewMode() || showLabel ? '' : 'never'">
  @if (appService.getViewMode() || showLabel) {
    <mat-label>{{label}}</mat-label>
  }
  <mat-select [id]="id" [formControl]="formControlSelect" [placeholder]="placeholderLabel" #test
    (selectionChange)="launchEvent($event)" (openedChange)="resetACDatas()" [required]="required" [multiple]="multiple">
    @if (multiple) {
      <mat-select-trigger>
        {{formControlSelect.value ? getFirstDataLabel() : ''}}
        @if (formControlSelect.value?.length > 1) {
          <span class="multipleLabels">
            (+{{formControlSelect.value.length - 1}} {{'lang.others' | translate | lowercase}})
          </span>
        }
      </mat-select-trigger>
    }
    <input matInput class="mat-select-search-input mat-select-search-hidden" />

    <div class="mat-select-search-inner"
      [ngClass]="{'mat-select-search-inner-multiple': matSelect.multiple}">
      <input id="searchSelectInput" [formControl]="formControlSearch" class="mat-select-search-input"
        #searchSelectInput (keydown)="_handleKeydown($event)" (input)="onInputChange($event.target.value)"
        (blur)="onBlur($event.target.value)" [placeholder]="'Saisissez un terme de recherche' | translate" />
      @if (formControlSearch.value && !loadingSearch) {
        <button mat-button mat-icon-button aria-label="Clear" (click)="_reset()"
          class="mat-select-search-clear">
          <mat-icon class="fa fa-times"></mat-icon>
        </button>
      }
      @if (loadingSearch) {
        <mat-spinner class="mat-select-search-loading" diameter="24"></mat-spinner>
      }
    </div>
    @if (noResult) {
      <div class="mat-select-search-no-entries-found" style="font-style: italic;opacity: 0.5;">
        {{'lang.noResult' | translate}}
      </div>
    }
    @if (showResetOption) {
      <mat-option [value]="null"><i>({{'lang.emptyValue' | translate}})</i></mat-option>
    }
    @for (value of filteredDatas | async; track value) {
      <mat-option [value]="returnValue === 'id' ? value.id : value"
        [title]="value.title !== undefined ? value.title : value.label" [disabled]="value.disabled"
        [class.opt-group]="value.isTitle" [style.color]="value.color">
        <span [innerHTML]="value.label"></span>
      </mat-option>
    }
  </mat-select>
  @if (formControlSelect.status!=='VALID' && formControlSelect.touched && !hideErrorDesc) {
    <mat-error>
    {{getErrorMsg(formControlSelect.errors)}}</mat-error>
  }
  @if (suffixIcon !== null) {
    <mat-icon style="height: auto;" matSuffix [style.color]="suffixIcon.color"
      class="fas fa-circle selectSuffixIcon" [title]="suffixIcon.title !== undefined ? suffixIcon.title : ''">
    </mat-icon>
  }
</mat-form-field>