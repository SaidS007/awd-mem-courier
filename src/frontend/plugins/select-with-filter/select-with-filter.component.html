<mat-form-field [appearance]="appearance" [title]="getSelectedItemsLabel()">
  @if (label !== null) {
    <mat-label>{{label}}</mat-label>
  }
  <mat-select #select [placeholder]="placeholder" [panelClass]="array.length > 5 ? 'appSelectFilterContainer' : ''" [(ngModel)]="data"
    (openedChange)="togglePanel($event)" [required]="isRequired()"
    [multiple]="multiple" [disabled]="isDisabled()" [ngModelOptions]="{standalone: true}"
    (selectionChange)="onChange($event.value)">
    @if (array.length > 5) {
      <app-filter style="display:contents" #appFilter [currentValues]="data" [array]="array"
        (filteredReturn)="filteredList=$event" [displayMember]="'label'">
      </app-filter>
    }
    @if (showResetOption) {
      <mat-option [value]="''">({{'lang.emptyValue' | translate}})</mat-option>
    }
    @for (item of array; track item) {
      <mat-option [value]="item.id" [class.hide]="!inFilteredItems(item)"
        [title]="item.title !== undefined ? item.title : item.label" [disabled]="item.disabled"
        [class.opt-group]="item.isTitle" [style.color]="item.color">
        <span [innerHTML]="item.label"></span>
      </mat-option>
    }
  </mat-select>
  @if (showError && showMsgErrors) {
    <mat-error [innerHTML]="errors"></mat-error>
  }
</mat-form-field>